<!DOCTYPE html>
<html lang="en">
    <head>
        <!-- Do we need to call MatPat again? This is so meta. -->
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="icon" type="image/x-icon" href="/Resources/Images/Favicon.ico">
        <title>Social</title>
        <link rel="stylesheet" href="/Resources/CSS/SocialStyle.css">
    </head>
    <body>
        <!-- Navigation Panel, contains tabs for parts of the site. -->
        <div class="nav-panel">
            <!-- Navbar content -->
            <div class="nav-content">
                <div class="window-title">
                    <p style="margin: 0;"> Black Ink Games </p> <!-- "Window Title" -->
                </div> 

                <!-- Buttons -->
                <div>
                    <a class="button" href="/" onclick="setSelected(this)"> Home </a>
                    <a class="button" href="/Gamejolt/" onclick="setSelected(this)"> GameJolt </a>
                    <a class="button" href="/itch/" onclick="setSelected(this)"> itch.io </a>
                    <a class="button" href="/Projects/" onclick="setSelected(this)"> Projects </a>
                    <a class="button selectedpage" href="/Social/" onclick="setSelected(this)"> Social </a>
                    <a class="button" href="/Blackfire-Interactive/" onclick="setSelected(this)"> Blackfire Interactive </a>
                </div>

                <div id="back" style="position: absolute; bottom: 20px; left: 0; width: 100%; display: none;">
                    <a class="button" onclick="closeNav()"> Back </a>
                </div>
            </div>
        </div>
        
        <div class="content-panel">
            <!-- This is the button for the navigation menu on small screens. -->
            <div class="nav-hamburger">
                <button class="button button2" style="width: 45px; height: 45px; margin-bottom: 0; font-family: 'Segoe MDL2 Assets', 'BIG-Icons'" onclick="openNav()"></button>
            </div>

            <!-- What are you doing on IE11 you psycho?? -->
            <div class="no-support">
                <h1> Using an archaic browser? You're out of luck but there will be a compatibility version of the site eventually. </h1>
            </div>

            <!-- Page content (The important bit!) -->
            <div class="content">
                <h1> Social </h1>
                <h2 style="margin-bottom: 0;"> CONTACT ME </h2>
                <p class="grey-p"> I'll respond to Emails pretty fast. You can also leave a shout on my GameJolt, but I don't check there often. </p>
                <br>
                <a class="button button2" style="height: 32px; padding-top: 5px;" href="https://gamejolt.com/@blackInk_Games"> GameJolt </a>
                <a class="button button2" style="height: 32px; padding-top: 5px;" href="mailto:jack@blackfire-interactive.website"> Email </a>
                <br>
                <h2 style="margin-bottom: 0;"> OTHER SOCIALS </h2>
                <p class="grey-p"> You can't necessarily contact me here, but I post on these platforms. </p>
                <br>
                <a class="button button2" style="height: 32px; padding-top: 5px;" href="https://github.com/Blackfire-IamaPineapple24"> GitHub </a>
                <a class="button button2" style="height: 32px; padding-top: 5px;" href="https://bsky.app/profile/black-ink-games.blackfire-interactive.website"> Bluesky </a>
                <br>
                <a class="button button2" style="height: 32px; width: 204px; padding-top: 5px;" id="openPosts" href="#"> Here! </a>
            </div>

            <!-- The sidebar. -->
            <div class="sidebar-content">
                <!-- Relaed Settings (Links to Windows Settings) -->
                <h3 style="margin-bottom: 10px;"> Related Settings </h3>
                <a href="ms-settings:privacy"> Change settings for privacy in Windows </a>
                <br style="margin-bottom: 13px;">
                <a href="ms-settings:appsfeatures"> Manage apps installed on your device </a>
                <br style="margin-bottom: 15px;">

                <!-- Help from the web (Just some fun links) -->
                <h3 style="margin-bottom: 10px"> Help from the web </h3>
                <a href="https://www.wikihow.com/Make-an-Email-Address-for-Free"> Creating an Email account </a>
                <br style="margin-bottom: 5px;">
                <a href="https://docs.github.com/en/get-started/start-your-journey/creating-an-account-on-github"> Creating an account on GitHub </a>
                <br style="margin-bottom: 5px;">
                <a href="https://bsky.social/about/blog/5-19-2023-user-faq"> Creating a Bluesky account </a>
                <br style="margin-bottom: 5px;">
                <a href="https://wamwoowam.co.uk/"> Viewing the site that gave me the idea <br> for this </a>
                <br style="margin-bottom: 5px;">
                <a href="javascript:var%20KICKASSVERSION='2.0';var%20s%20=%20document.createElement('script');s.type='text/javascript';document.body.appendChild(s);s.src='//hi.kickassapp.com/kickass.js';void(0);"> Destroying webpages with Kickassapp </a>
                <br style="margin-bottom: 18px;">

                <!-- Give Feedback (Opens Github Issues) -->
                <div style="display: flex; align-items: center; gap: 6px;">
                    <p style="font-family: 'Segoe MDL2 Assets', 'BIG-Icons', sans-serif; margin: 0; font-size: 12pt; line-height: 1;"></p>
                    <a href="https://github.com/Blackfire-IamaPineapple24/black-ink-games/issues/new"> Give Feedback </a>
                </div>

                <br style="margin-bottom: 15px;">
            </div>
        </div>

        <!-- This is the popup window for posts. Obviously. -->
        <div class="popup-window" id="popupWindow">
            <div class="title-bar" id="popupTitleBar">
                <span class="title-text"> Posts </span>
                <div class="close-button" id="popupCloseBtn"></div>
            </div>
            <div class="popup-content" id="popupContent">
                <button id="popupBack" style="margin-top: 10px; display: none;" class="button3"> Back </button>
                <div id="popupHome">
                    <h3> Links </h3>
                    <ul>
                        <li> <a class="popup-link" href="/Social/Posts/20-2-26.html"> Notes on new Cortana commits (20/2/26) </a> </li>
                        <li> <a class="popup-link" href="/Social/Posts/Linux/Linux.html"> Linux (24/1/26) </a> </li>
                        <li> <a class="popup-link" href="/Social/Posts/FixedTheSidebar.html"> Fixed the Sidebar (23/1/26) </a> </li>
                        <li> <a class="popup-link" href="/Social/Posts/PostsPageDone.html"> Posts Page Done! (20/01/26) </a> </li>
                    </ul>
                </div>
                <iframe id="popupIframe" style="display: none; width: 100%; height: 100%; border: none; background: inherit;"></iframe>
            </div>
        </div>
        <script>
            // References
            const buttons = document.querySelectorAll('.button');
            const currentButton = document.querySelector('.selectedpage');
            const navMenu = document.querySelector('.nav-panel');
            const backButton = document.getElementById('back');
            const popupWin = document.getElementById("popupWindow");
            const popupClose = document.getElementById("popupCloseBtn");
            const popupTitleBar = document.getElementById("popupTitleBar");
            const popupOpen = document.getElementById("openPosts");
            const popupContent = document.getElementById("popupContent");
            const popupHome = document.getElementById("popupHome");
            const popupIframe = document.getElementById("popupIframe");
            const popupBack = document.getElementById("popupBack");

            const isThin = window.matchMedia("(max-width: 1130px)").matches;
            const closeButton =document.getElementById("popupCloseBtn");
            
            // Tracks the mouse and sets a radial gradient on the mouse's position for all elements with the .button CSS class.
            document.addEventListener('mousemove', (e) =>
            {
                buttons.forEach(button =>
                {
                    const rect = button.getBoundingClientRect();
                    const xPer = ((e.clientX - rect.left) / rect.width * 100);
                    const yPer = ((e.clientY - rect.top) / rect.height * 100);
    
                    button.style.setProperty('--light-x', `${xPer}%`);
                    button.style.setProperty('--light-y', `${yPer}%`);
                    button.style.setProperty('--light-opacity', 0.08);
                });
            });

            buttons.forEach(button =>
            {
                button.addEventListener('mousedown', () =>
                {
                    button.classList.remove('click-animate');
                    void button.offsetWidth;
                    button.classList.add('click-animate');
                });
            });

            window.addEventListener('DOMContentLoaded', () =>
            {
                const selectedButton = document.querySelector('.button.selectedpage');
                selectedButton.classList.add('animate');
            })

            function openNav()
            {
                navMenu.classList.remove('closing');
                navMenu.classList.add('open');
                backButton.style.display = 'block';
            }
            function closeNav()
            {
                navMenu.classList.add('closing');
                navMenu.classList.remove('open');

                setTimeout(() => {
                    backButton.style.display = 'none';
                    navMenu.classList.remove('closing')
                }, 400);
            }

            function setSelected(element)
            {
                currentButton.classList.remove('selectedpage');
                element.classList.add('selectedpage');
            }

            // Make the window visible
            popupOpen.addEventListener("click", (e) =>
            {
                e.preventDefault(); 
                popupWin.classList.add("open");
            });

            // Close the window
            popupClose.onclick = () =>
            {
                popupWin.classList.remove("open");
            
                setTimeout(() =>
                {
                    popupIframe.style.display = "none";
                    popupIframe.src = "";
                    popupBack.style.display = "none";
                    popupHome.style.display = "block";
                }, 500);
            };

            // Make the window draggable
            let offsetX = 0, offsetY = 0, isDown = false;
            popupTitleBar.addEventListener("mousedown", function(e)
            {
                if (e.target === popupClose || popupClose.contains(e.target)) return;
                isDown = true;
                offsetX = e.clientX - popupWin.offsetLeft;
                offsetY = e.clientY - popupWin.offsetTop;
                e.preventDefault();
            });
            document.addEventListener("mousemove", function(e)
            {
                if (!isDown) return;
                popupWin.style.left = (e.clientX - offsetX) + "px";
                popupWin.style.top = (e.clientY - offsetY) + "px";
            });

            document.addEventListener("mouseup", () => { isDown = false; });

            // Does the browser support MDL2 Assets? This creates a fallback in case it doesn't.
            // Not using the BIG-Icons font here because Unicode already has a standard character that looks VERY similar, ✕.
            
            // This function detects if the specified character exists in the font the device is using.
            function fontSupportsCharacter(font, character) {
                const canvas = document.createElement("canvas");
                const ctx = canvas.getContext("2d");
                ctx.font = `100px ${font}, monospace`;
                const widthWithFont = ctx.measureText(character).width;
                ctx.font = "100px monospace";
                const widthWithoutFont = ctx.measureText(character).width;
                return widthWithFont !== widthWithoutFont;
            }

            // Actually change the glyph based on its availability
            if (fontSupportsCharacter("Segoe MDL2 Assets", ""))
            {
                closeButton.textContent = "";
                closeButton.style.fontFamily = '"Segoe MDL2 Assets", sans-serif';
            }
            else
            {
                closeButton.textContent = "✕";
                closeButton.style.fontFamily = '"Arial", sans-serif';
            }

            // Load posts into the popup
            function loadPost(url) {
                fetch(url)
                    .then(res => res.text())
                    .then(html => {
                        popupIframe.srcdoc = ""; // Reset the iframe
                        popupIframe.style.display = "block"; // Make it visible
                    
                        const iframeDoc = popupIframe.contentDocument || popupIframe.contentWindow.document;
                        iframeDoc.open();
                        iframeDoc.write('<!DOCTYPE html><html lang="en"><head><title>Post</title>');
                        
                        iframeDoc.write(`<base href="${window.location.origin}/">`);
                        
                        // Keep fonts/icons
                        const allStyles = document.querySelectorAll('style');
                        allStyles.forEach(style => {
                            const content = style.textContent;
                            if (content.includes('@font-face')) {
                                const fontStyle = document.createElement('style');
                                fontStyle.textContent = content;
                                iframeDoc.head.appendChild(fontStyle);
                            }
                        });
                    
                        // This goddamn CSS istg
                        /* It needs to be seperate so that the rules for
                           thin screens apply to the popup iframe. don't ask why,
                           just be thankful it works. */
                        /* Anyway, this "line" writes CSS to the iframe so that I
                           don't need to do it for every post. */
                        iframeDoc.write(`
                            <style>
                                html, body {
                                    margin: 0;
                                    padding: 15px;
                                    font-family: "Segoe UI", sans-serif;
                                    background: inherit !important;
                                    line-height: 1.5;
                                }
                            
                                a {
                                    color: #0066cc !important;
                                    text-decoration: none;
                                }
                                a:hover {
                                    color: #0055aa !important;
                                }
                            
                                @media (max-width: 1130px) {
                                    a {
                                        color: #60a5fa !important;
                                    }
                                    a:hover {
                                        color: #93c5fd !important;
                                    }
                                }
                            </style>
                        `);
                        
                        iframeDoc.write('</head><body>');
                        iframeDoc.write(html);
                        
                        /* Override anything that still tells the text to be white
                           on widescreen. (yes this code is messy shut up) */
                        const isThin = window.matchMedia("(max-width: 1130px)").matches;
                        const targetColor = isThin ? 'white' : 'black';
                        
                        const textElements = iframeDoc.body.querySelectorAll('h1, h2, h3, h4, h5, h6, p, span, div, li, strong, em, a');
                        textElements.forEach(el => {
                            el.style.color = targetColor;
                        });
                    
                        // Same thing as above basically
                        iframeDoc.body.style.color = targetColor;
                    
                        iframeDoc.write('</body></html>'); // Finish writing html
                        iframeDoc.close();
                    
                        iframeDoc.defaultView.scrollTo(0, 0);
                    })
                    .catch(err => console.error("Error loading post:", err));
            }

            // Handle clicks, open links
            popupContent.addEventListener("click", function(e)
            {
                const link = e.target.closest(".popup-link");
                if (!link)
                {
                    return;
                }
                e.preventDefault();
                popupHome.style.display = "none";
                popupIframe.style.display = "block";
                popupBack.style.display = "block";
                const url = link.getAttribute("href");
                loadPost(url);
            });

            // Close the post
            popupBack.addEventListener("click", () =>
            {
                popupIframe.style.display = "none";
                popupIframe.src = "";
                popupBack.style.display = "none";
                popupHome.style.display = "block";
            });

            // Function to change button type based on screen size
            function selectButtonType(thin)
            {
                popupBack.classList.remove("button", "button2", "button3");

                if (thin)
                {
                    popupBack.classList.add("button", "button2");
                    popupBack.style.height = "32px";
                    popupBack.style.fontFamily = `"Segoe UI", sans-serif`;
                    popupBack.style.fontWeight = "300";
                }
                else
                {
                    popupBack.classList.add("button3");
                    popupBack.style.height = "25.5px";
                    popupBack.style.fontFamily = `"Segoe UI", sans-serif`;
                    popupBack.style.fontWeight = "300";
                }
            }

            // Make popup text color adaptive on resize
            window.addEventListener('resize', () => {
                if (!popupIframe.contentDocument) return;  // iframe not open/loaded yet
            
                const iframeDoc = popupIframe.contentDocument;
                const isThin = window.matchMedia("(max-width: 1130px)").matches;
                const targetColor = isThin ? 'white' : 'black';
            
                if (iframeDoc.body) {
                    iframeDoc.body.style.color = targetColor;
                }
            
                const textElements = iframeDoc.querySelectorAll('h1, h2, h3, p, span, div, li, strong, em, a');
                textElements.forEach(el => {
                    el.style.color = targetColor;
                });

                selectButtonType(isThin);
            });

            selectButtonType(isThin);
        </script>
    </body>
</html>